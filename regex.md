### Регулярки для выпиливания синтаксиса MS SQL
`(with\s*)?\(\s*nolock\s*\)|\(\s*rowlock\s8\)` - удаляем

`outer apply` - `LEFT JOIN LATERAL`

`cross apply` - `INNER JOIN LATERAL`

`isnull` - `COALESCE`

`convert\s*\(([^\,]+)\,\s*([^\,]+)\,\s*126\s*\)` - `to_char($2, 'YYYY-MM-DD"T"HH24:MI:SS')`

`convert\s*\(([^\,]+)\,\s*([^\,]+)\,\s*104\s*\)` - `to_char($2, 'DD.MM.YYYY')`

`convert\s*\(([^\,]+)\,\s*([^\,]+)\,\s*108\s*\)` - `to_char($2, 'HH24:MI:SS')`

`convert\s*\(([^\,]+)\,\s*([^\,]+)\,\s*120\s*\)` - `to_char($2, 'YYYY-MM-DD HH24:MI:SS')`

### Регистр возвращаемых запросами полей
Чтобы поля выгребались в правильном регистре нужно добавлять им алиасы, например:
`Evn_id` в select заменяем на `Evn_id as "Evn_id"`, могут помочь регулярки:

`as (\w+)` - `as \\"$1\\"`

`\.(\w+)(,*)\n` - `\.$1 as \\"$1\\"$2\n`

###Процесс рефакторинга модели
* Переносим нужную модель в папку `_pgsql`
* Из корня проекта выполняем скрипт `php replace.php _pgsql/{Model_name}.php`
* В IDE в режиме поиска ищем все конструкции `SELECT TOP` и заменяем на соответствующие в PgSQL
* В папке `promed/tests/models` создаем новый тест-кейс, по аналогии с уже имеющимися
* Пишем тест-кейс желательно по методам где есть вводные параметры (фильртры и тд) делать отдельную функцию в тесткейсе
* Дебажим
* Сдаем на проверку